var _PREVIEW_URL;function requests(url,form,div){$.ajax({data:$(form).serialize(),type:"POST",url:url,success:function(data){update(div,data)},fail:function(err){alert(err),console.log(err)}})}function update(div,data){var string='<div class="text-center"><p class="card-text"> El registro de fichaje solo funcionar? a trav?s del siguiente <a href="javascript:window.open(\'https://horacloud.herokuapp.com/DATA\',\'\',\'toolbar=yes\');void 0" target="_blank">link</a> luego de haber generado el token de seguridad.</p><a href="javascript:window.open(\'https://horacloud.herokuapp.com/DATA\',\'\',\'toolbar=yes\');void 0"  target="_blank" class="btn btn-outline-default btn-rounded waves-effect">Nueva ventana de Fichaje</a></div>';string=string.split("DATA").join(data),$(div).html(string)}function showShift(){$.ajax({data:{id:$("#employeeId").val()},type:"POST",url:"/employees/shift",success:function(data){data.result?($("#showShiftTrue").show(),$("#shiftTitle").text(data.data.description),$("#shiftStart").text(data.data.start),$("#shiftBreakTime").text(data.data.breaktime),$("#shiftDays").text(data.data.days.toString()),$("#shiftEnd").text(data.data.end),$("#showShiftFalse").hide()):(data.data.forEach(element=>{$("#shiftSelect").append('<option value="'+element._id+'">'+element.name+"</option>")}),$("#showShiftFalse").show(),$("#showShiftTrue").hide())},fail:function(err){alert(err),console.log(err)}})}function addShift(){var mod=$("#EmployeeShift");mod.modal("show"),mod.find("#shiftForm-btn").click(function(){$.ajax({data:$("#shiftForm").serialize(),type:"POST",url:"/employees/shift/add",success:function(data){calendar.refetchEvents()},fail:function(err){alert(err),console.log(err)}}),$("#shiftForm").trigger("reset"),mod.modal("hide")})}$(".button-collapse").sideNav(),$(".timepicker").pickatime({default:"",cleartext:"cancelar",donetext:"listo"}),$(".datepicker").pickadate(),$("#rruleCheck").change(function(e){$("#rrule").is(":visible")?$("#rrule").css("display","none"):$("#rrule").css("display","block")}),$('[data-toggle="popover-hover"]').popover({html:!0,trigger:"hover",placement:"right",content:function(){return $(this).data("text")}}),$(document).ready(function(){$("#dtMaterialDesignExample").DataTable(),$("#dtMaterialDesignExample_wrapper").find("label").each(function(){$(this).parent().append($(this).children())}),$("#dtMaterialDesignExample_wrapper .dataTables_filter").find("input").each(function(){$("input").attr("placeholder","Search"),$("input").removeClass("form-control-sm")}),$("#dtMaterialDesignExample_wrapper .dataTables_length").addClass("d-flex flex-row"),$("#dtMaterialDesignExample_wrapper .dataTables_filter").addClass("md-form"),$("#dtMaterialDesignExample_wrapper select").removeClass("custom-select custom-select-sm form-control form-control-sm"),$("#dtMaterialDesignExample_wrapper select").addClass("mdb-select"),$("#dtMaterialDesignExample_wrapper .mdb-select").materialSelect(),$("#dtMaterialDesignExample_wrapper .dataTables_filter").find("label").remove()}),$("#deleteAlertModal").on("show.bs.modal",function(event){var button=$(event.relatedTarget),action=button.data("action"),name=button.data("name"),modal=$(this);modal.find(".modal-title").text("Eliminar "+name),modal.find(".text-danger").text("Estรก a punto de eliminar a | "+name+" | por favor confirme su selecciรณn."),modal.find("#deleteForm").attr("action",action)}),$(document).ready(function(){$(".mdb-select").materialSelect()}),document.addEventListener("DOMContentLoaded",function(){var calendarEl=document.getElementById("calendar"),employee=$("#employeeId").val(),calendar=new FullCalendar.Calendar(calendarEl,{plugins:["interaction","dayGrid","timeGrid","list","rrule","bootstrap"],locale:"es-us",themeSystem:"bootstrap",header:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},defaultDate:Date.now(),editable:!0,selectable:!0,weekNumbers:!0,weekNumbersWithinDays:!0,weekNumberCalculation:"ISO",selectMirror:!0,eventDragStop:function(event,jsEvent,ui,view){console.log(event),$.ajax({data:{id:event.event.id,_method:"DELETE"},type:"POST",url:"/employees/calendar/move",success:function(data){event.event.remove()},fail:function(err){alert(err),console.log(err)}}),console.log(event.event.id)},select:function(arg){var mod=$("#CalendarEvents");mod.find("#CalendarEventsTitle").text("Crear evento al: "+arg.startStr),mod.find("#start").val(arg.start),mod.find("#dtstart").val(arg.startStr),mod.modal("show"),mod.find("#eventForm-btn").click(function(){$.ajax({data:$("#eventForm").serialize(),type:"POST",url:"/employees/calendar/add",success:function(data){calendar.addEvent(data)},fail:function(err){alert(err),console.log(err)}}),$("#eventForm").trigger("reset"),mod.modal("hide")}),calendar.unselect()},editable:!0,navLinks:!0,eventLimit:!0,events:{url:"/employees/calendar/"+employee,failure:function(){document.getElementById("script-warning").style.display="block"}},eventDoubleClick:function(arg){confirm("delete event?")&&arg.event.remove()}});calendar.render()}),$("#shiftChange").on("click",function(e){var confirm;e.preventDefault(),"desactivar"==prompt('Escriba "desactivar" para confirmar')&&$.ajax({data:{id:$("#employeeId").val()},type:"POST",url:"/employees/shift/deactivate",success:function(data){data.result?($("#showShiftTrue").hide(),data.data.forEach(element=>{$("#shiftSelect").append('<option value="'+element._id+'">'+element.name+"</option>")}),$("#showShiftFalse").show()):($("#showShiftFalse").hide(),$("#showShiftTrue").show())},fail:function(err){alert(err),console.log(err)}})}),document.querySelector("#upload-dialog").addEventListener("click",function(){document.querySelector("#image-file").click()}),document.querySelector("#image-file").addEventListener("change",function(){var file=this.files[0],mime_types;-1!=["image/jpeg","image/png"].indexOf(file.type)?file.size>2097152?alert("Error : Exceeded size 2MB"):(_PREVIEW_URL=URL.createObjectURL(file),document.querySelector("#preview-image").setAttribute("src",_PREVIEW_URL),document.querySelector("#preview-image").style.display="inline-block"):alert("Error : Incorrect file type")});